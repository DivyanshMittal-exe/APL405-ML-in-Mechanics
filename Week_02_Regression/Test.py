import os
import matplotlib.pyplot as plt
import numpy as np
from Week2_Q1_Template import nlr

data = np.loadtxt('prob1data.txt', delimiter=',')

x = data[0]
y = data[1]

iters = 10000

w = np.random.rand(3)


iters = 50000

w = np.random.rand(3)
nlr_obj = nlr()

mat = np.vstack([np.ones(x.size),x,np.square(x)])
# b = nlr_obj.SgradientDescent(mat.T,y,w.copy(),0.01,iters)
# a = nlr_obj.BgradientDescent(mat.T,y,w.copy(),0.01,iters)

# x_ar = [i for i in range(iters)]
# y_ar = a[1]
# y_ar_s = b[1]



# plt.plot(x_ar,y_ar_s,label='Stochastic gradient descent')
# plt.plot(x_ar,y_ar,label='Batch gradient descent')
# plt.title("J vs iterations")
# plt.xlabel('No of iterations')
# plt.ylabel('J')  
# plt.legend()
# plt.savefig('GradDescent_1_copy.png',dpi=500)
# plt.show()



nlr_obj = nlr()

nlr_obj = nlr()
a = nlr_obj.AgradientDescent(mat.T,y,w.copy(),iters)
print(a)
x_ar = [i for i in range(len(a[1]))]
y_ar = a[1]
# print(a)
plt.plot(x_ar,y_ar,label='Batch gradient descent')
plt.title("J vs iterations")
plt.xlabel('No of iterations')
plt.ylabel('J')  
plt.legend()
plt.savefig('AgradientDescent.png',dpi=500)
plt.show()

#y_ar = [22.596139360801367, 20.880816720018082, 22.542576162005396, 14.714501702717046, 18.394183715842342, 15.954913755986327, 15.830927862344694, 15.844628193685844, 15.673632641598605, 14.574184945746298, 13.931388370751622, 13.392205663285186, 14.932764702901958, 13.056690926925917, 11.153234749655152, 11.02789187757449, 11.172453873904002, 11.084370788099106, 11.15619604340721, 11.134643806970399, 11.129145339396606, 10.136084210597453, 9.16685735590754, 8.833912406737767, 9.231187965356872, 8.092770013720626, 8.426656556846591, 7.8923104448141155, 7.805926892937724, 7.525815328417918, 7.7339620848848165, 7.6098355222478435, 7.2865803752756, 6.641763842781445, 6.31050152493595, 6.303813998653346, 5.8814546167030635, 5.701630176266197, 5.639513715060023, 5.672286241246321, 5.498821505964826, 5.36253245770146, 5.561942646739232, 5.452969881688997, 5.231496113987284, 5.362333780824686, 5.362065774848991, 5.32137544520199, 5.441600220310176, 5.209618865103873, 5.30078532376286, 4.73587270972993, 5.006426645658613, 2.8475060267594903, 4.62995259214841, 4.425513246816731, 4.351371333233386, 4.365601248776325, 4.439736946140451, 4.074032141152113, 4.324765391135873, 4.366518637215583, 4.3390705681093475, 4.302249087081998, 4.635995122293646, 4.233647554593614, 4.772402304120575, 4.039703432470641, 4.113464877786607, 4.200094349357133, 3.793212319606, 4.334941869433541, 4.044606262187083, 5.753114996644111, 3.769759201183646, 4.0234033125820385, 3.8634782586631022, 3.794310372085555, 3.9023504817380075, 3.8886150135950692, 3.926901582776517, 3.6275794091654814, 3.8163208148329324, 3.474876156226166, 3.6517339233309585, 3.56973457133327, 3.7211127592295976, 3.59402024057866, 3.654196366434631, 3.683475297158919, 3.577145781835102, 3.00485424275454, 3.444610762125636, 3.438079592009699, 3.4410695446429242, 2.8467099105530305, 3.1885896707815795, 3.443094228067483, 3.375588271844773, 3.8256026515503443, 2.558792406706234, 3.189864346790688, 2.8696520121108984, 3.3176048592376755, 3.2268229932208343, 3.1659126803216924, 18.57150688194624, 3.1711707467996058, 3.314965140960119, 3.310054110668947, 3.341141397859748, 3.1466010609235844, 3.316342387824626, 3.1374921739471047, 3.260880874376229, 3.2058834396892717, 3.214391100439403, 2.9951508655919317, 3.1600770410669226, 3.1657996932744856, 3.173301409517189, 3.4582865333802904, 2.7162162993366366, 3.118215971069245, 3.0090159601646844, 2.9207291775276985, 3.0195048381953558, 3.03161320034158, 3.097496075354974, 3.0584497081918944, 3.095575006209464, 3.217774043162282, 3.0354411443880114, 3.0232426334203972, 3.151068129391372, 3.050027051716756, 3.1184475181683085, 2.905026121850613, 3.025274679623293, 2.998015490618438, 2.9618046481219333, 2.9301697951402503, 2.955538722613313, 2.9170124356560128, 2.5492934549885344, 2.9355223495304616, 2.8189580023052017, 2.726401527725602, 2.6956407156858524, 2.8111791580591126, 2.7030693856615287, 2.857205284907215, 2.8328376632597307, 2.7207218931558095, 2.6781723960848063, 2.7794530261516215, 2.8689262771699346, 2.614897497672576, 3.112660837109724, 2.104922416724587, 2.7537027747078633, 2.662501655805723, 2.6801090999602644, 2.8350395284367362, 2.5614767041080344, 2.52482360012208, 2.651016087845676, 2.6589255057716814, 2.5334561019261015, 2.6273779530407504, 2.5564571314187177, 2.740796661772964, 2.6119026761613675, 2.620893978451273, 2.9187459567474674, 1.9642579596761724, 2.572620716348119, 2.514931311937783, 2.577304399124139, 2.8067201390145833, 2.503630202240349, 2.4624187602891694, 2.403499047883152, 2.164335452475168, 2.5761644479191252, 2.572093235072327, 2.514865786102657, 2.5794076839254694, 2.5628179148290346, 2.5153074207886443, 2.4800120871378644, 2.4732348019950403, 2.5394239656569915, 2.523371040601959, 2.4301425067487297, 2.3630266936713067, 2.4510268325753213, 2.4186450291133545, 2.5288704762689163, 2.7865924088294367, 2.436650043300537, 2.345364238024884, 2.0738179451811263, 2.383109274145838, 2.3781777130785526, 2.408000036752841, 2.39293540760799, 2.375936553101035, 2.3623104473103274, 2.3456017843031387, 2.2529317406499865, 2.342682134880196, 2.225119064295177, 2.3914645630060414, 2.3844470551261123, 2.276006086818564, 2.36636991552558, 2.356298058671696, 2.4225614851108217, 2.212783651800657, 2.4520124642592243, 1.9372973140988738, 2.194790736788055, 2.143078712346467, 2.083190897121361, 2.124724773576564, 2.2686207550830466, 2.1833956042221487, 2.202499920314579, 2.2781142746773284, 2.17806434133277, 2.3037865299520828, 1.8632355867938848, 2.2253621345552435, 2.103284446501383, 2.0959194767669778, 2.421842961523116, 1.6383834342257233, 2.1905658232834306, 2.1571546157971384, 2.1918293718268367, 2.338275650766548, 2.0505350784692973, 2.1381775501602904, 2.102209049717283, 2.1932682825366467, 2.2172265286272332, 1.9768632789219294, 2.0881083808112115, 1.9496119357747899, 2.0818175289459355, 2.000176384549898, 1.982312941216486, 2.0405692651950127, 2.084522131254916, 2.0680310737760252, 2.0975997934982904, 1.9895318344645436, 2.0855040558984244, 2.0429602426668443, 1.9448062590108097, 2.2081432565171832, 1.9786838888884188, 2.034733314445839, 1.9463802692359005, 2.0158817338930035, 2.028185533200118, 1.9275269782811608, 1.9215473163770582, 1.9358869520204374, 1.9750633795265404, 1.9407037265261218, 1.915386075171535, 1.8880217918197781, 1.8925245897063596, 1.851916015802846, 1.8116479718197709, 2.0968376607066226, 1.8504098095059085, 1.8428389353177583, 1.876267056846675, 1.8102140189172893, 1.8873589233606687, 1.9221485847730841, 10.327380943860291, 1.9016326242690569, 1.9783517336416683, 1.8512769819761956, 1.8781511265328394, 1.9158797096943747, 1.5735988219858421, 1.095842477298459, 1.843398386048294, 1.9714211726480417, 1.8889053795715647, 1.8976412660997528, 1.8565075484020932, 1.8363086659431611, 1.8346467332321965, 1.8305315612128357, 1.7899791416307038, 1.8952354787668526, 1.7439653704578884, 1.8144832005090843, 1.7649217133255166, 1.8173960156442717, 1.8288359173731277, 1.8804530607272543, 1.8230183444030423, 1.7424681698766915, 1.6806309365243137, 1.7602754610811326, 1.772648201904153, 1.6936379170948153, 1.624472366315427, 1.8056597387423037, 1.7998086554030104, 1.7244293956407029, 1.6832541341487133, 1.7380901567571847, 1.9570682444430527, 1.7510834512081093, 1.590026855541397, 1.6763442547440202, 1.7420772808747724, 1.6668959918928645, 1.6559247994650557, 1.5610426869002638, 1.4372513214353015, 1.5513008101431, 1.6542758679753482, 1.621370454617316, 1.6361404211283115, 1.3787511199929812, 1.6448056236879616, 1.6498532348352741, 1.1193913055463138, 1.6171751483963186, 1.59071938497011, 1.6933405654757885, 1.6092706377749697, 1.6455975600796169, 1.5157237456371042, 1.8063344476646537, 1.180231250915532, 1.5460960674001942, 1.3222959358847088, 1.577099601492598, 1.5418101060767093, 1.5448627423012955, 1.5169817459574984, 1.448977252794142, 1.5512832293998124, 1.4690218550514456, 1.5185654388126097, 1.4982650699215978, 1.4502464544749778, 1.4737246303363123, 1.4816379223721574, 1.3873882664640067, 1.4801862888051907, 1.4411767885588478, 1.4000855364918887, 1.54424535960497, 1.475017749081039, 1.4736003185231297, 1.374153393856062, 1.3989354990264136, 1.4100314758850647, 1.4385608742452014, 1.4585279231709292, 1.555124149721769, 1.3316719498685645, 1.4757462447204337, 1.603478250588364, 1.0610408870722903, 1.2056263576716508, 1.3700411301873467, 1.3846924900618276, 1.4375340401619228, 1.3626034988449498, 1.4065049646714942, 1.3846555375341232, 1.3140862283994275, 1.406956917012733, 1.3865376290465738, 1.4094364671808624, 1.3818265295152234, 1.2967795589410478, 1.3547397686099898, 1.4131471790191086, 1.370002106131628, 1.303188994392875, 1.3279735326998126, 1.358022741559658, 1.3062262760229246, 1.339801981464944, 1.3674474879701666, 1.4229058631646507, 1.3476560984323471, 1.241605209291191, 1.3577800163654616, 1.3236276306183883, 1.3013613069996202, 1.323640471908046, 1.3316261463596362, 1.3092793098055449, 1.3087991770735745, 1.2819191528102873, 1.2162291249740111, 1.4343373060264257, 1.2413609946614932, 1.2521830327512424, 1.2730551122183689, 1.274452190816941, 1.2788260987314022, 1.210273511627314, 1.2399490308619203, 1.238389412241359, 1.2746411583074926, 1.24984148832886, 1.2450353801886038, 1.223291407112216, 1.1923561834616454, 1.2238430621446108, 1.2028885607975528, 1.0724951901387416, 1.2782093794669898, 1.2378192855145271, 1.2148220247417079, 1.1930480437529842, 1.2194954106884972, 1.179687083650231, 1.3659937032992626, 0.8859424060086931, 1.2347617408321683, 1.2088588558814852, 1.2037826682298507, 1.1666217735029165, 1.1988811577938525, 1.1296354687176071, 1.1913584358302443, 1.1524932112238429, 1.1344733675987544, 1.1632562277943286, 1.163611072509942, 1.1264659376593193, 1.1415628543188316, 1.0724151365226344, 0.9609796405888678, 1.119240780417889, 1.1921994403664433, 1.1285641320819446, 0.9581283033453853, 1.1385005268324393, 1.1286214967614145, 1.2280054823642983, 1.1078806475657845, 1.0924602355940358, 1.0840051393311083, 1.2654309913968795, 1.118744135860606, 1.0817342753803805, 1.0917945176550397, 1.142028023786703, 1.1176548185309234, 1.0877903114947272, 1.088384456618653, 1.1043674280889515, 1.082547235057478, 1.0965365774148665, 1.0089601617847972, 1.0854755633640458, 1.1049843304975344, 1.0930987122694171, 1.0784301585625082, 1.09106416673725, 1.0809108144364574, 1.0681994314900678, 1.0137963750722518, 1.0340186378056788, 1.0620027904125702, 1.0244253386028421, 1.025619681368414, 1.0326079015312561, 1.0171090002953547, 1.1107903281243519, 1.0525062634536626, 1.045637967593943, 0.9852640716535963, 1.0347963940295708, 1.0282694815040825, 1.0039624418014874, 1.0058353123347619, 0.8776126308932932, 1.0121868122809954, 0.9923628007593119, 1.0054863153329263, 0.9754715063837373, 0.9877153514426507, 1.080621103704648, 0.974146491592171, 0.9704457146324945, 1.006281379368393, 0.966065825333076, 0.9901330056681605, 0.9474159563983787, 0.9558828798176124, 0.9452439487156281, 0.955283548177207, 0.9098052976115737, 0.9169546865710099, 0.9970189732043178, 1.0090441563721153, 0.9679925583649417, 0.975929483147537, 0.9665928571103576, 0.9389234605330171, 0.9668517601403797, 1.0437998402392992, 0.901855531133327, 0.9337938350649491, 0.9252984650473773, 0.9822377244983596, 1.0241560095071982, 0.9683002953436504, 0.9424549422444168, 0.9094872566703378, 0.9429956159284091, 0.9134767329292848, 0.9087119083419288, 0.9015602336304415, 0.9297471029424402, 0.9013893675340241, 0.8792337058785591, 0.8945078241425535, 0.9036068453375886, 0.8387217031399933, 0.8339696943289145, 0.9169578534224627, 0.8711463837739497, 0.8846981336114323, 0.8882393286469794, 0.8576219678834044, 0.9537493974706401, 0.7560619994732619, 0.976304960080579, 0.6530853315668798, 0.8514032162076105, 0.827764712504081, 0.8746211607170495, 0.8478168773919771, 0.8653865983462765, 0.7491124500866921, 0.8050296225859415, 0.8426667070980717, 0.8575673230117958, 0.8359532169274789, 0.8422810081699874, 0.8623227694696164, 0.9211240848625808, 0.8370169343571217, 0.8348480448482032, 0.8390373526332531, 0.7171191729215902, 0.829812746046776, 0.832775375412094, 0.8103788097095324, 0.7925948928994178, 0.800689543855455, 0.8045503542969735, 0.8192940201011298, 0.7770923025079842, 0.7082765811271513, 0.8065446944643467, 0.7678693855329326, 0.7625659193677716, 0.7988468087178858, 0.832998448209587, 0.793144950453518, 0.7804640569702999, 0.6843069518763139, 23.647755497285434, 0.8114556095530995, 0.7852056504333752, 0.8593971268344208, 0.8118016237005646, 0.7688594134778628, 0.43853031359990713, 0.7884552152773306, 0.7800069591715112, 0.7267992382585764, 0.7260922841923261, 0.7272751774535487, 0.7187350933808406, 0.7119126739319397, 0.7692646211627249, 0.7094372232218232, 0.7626659672216602, 0.7367258453044503, 0.7496927609172356, 0.7303501729974965, 0.8116227038760573, 0.7615147220628595, 0.7233906985139587, 0.7421700820496719, 0.733466725863897, 0.7139922475951981, 0.7155733938623609, 0.7282119967302632, 0.7115440034215674, 0.6941421146124567, 0.6884785045765219, 0.7049297624460561, 0.6760273401635175, 0.7056602773975087, 0.6765318873603118, 0.7002316160023483, 0.6999987171837639, 0.7049991576747172, 0.7213884665557084, 0.660615975726605, 0.7917708292558207, 0.5295867519739086, 0.699842247907589, 0.6935165913416249, 0.6885828541609577, 0.731923143376215, 0.7792218467347993, 0.5117969695595033, 0.6877234040390503, 0.7542111813446403, 0.6702380374788603, 0.6664512630585365, 0.6771548896075851, 0.6757421660973653, 0.6735900821025941, 0.638312740575762, 0.6698935039058493, 0.6736010714193951, 0.6750878793390582, 0.6360100415266103, 0.68625818699945, 0.7509227240860606, 0.5030052240722792, 0.6758758269334106, 0.6718355093014384, 1.1055866651259918, 0.6665366823707263, 0.6683597519299725, 0.6318960049213852, 0.666904782822245, 0.6632947790627524, 0.6600225667837859, 0.687950715057997, 0.6479786385053484, 0.6066154680853633, 0.646720761219789, 0.6067661865838125, 0.6405415880997314, 0.6195036882705888, 0.5414755970437753, 0.6430127022021749, 0.7040430488039281, 0.6382379855728777, 0.6586699771499891, 0.6190317361266903, 0.6305077943102243, 0.6243141557107309, 0.7118110457752962, 0.46824151554051213, 0.6189756003489204, 0.6250953524565469, 0.6103604708632197, 0.5943055505208518, 0.619354960101053, 0.672780858418831, 0.5890688913031779, 0.6167872990517197, 0.6250554094359255, 0.6133619343746726, 0.5970057801281294, 0.6197150864513583, 0.6769972864650057, 0.6154971302666634, 0.5845665525969593, 0.6057060300682897, 0.67586718785949, 0.5898292058316187, 0.6322581452019, 0.6087226749185449, 0.5882844658426004, 0.5994704285611957, 0.5261615329999094, 0.5904806290615968, 0.5909030102777013, 0.5523514830078531, 0.5813639058313047, 0.5596680802583852, 0.5916731134518187, 0.585078170298187, 0.5962688465939835, 0.604768145882921, 0.569920801370342, 0.5954001455693564, 0.5668316119126139, 0.5429133531049984, 0.5809881674752189, 0.6594495867182975, 0.5678917376177864, 0.5555021746658687, 0.5786787064325611, 0.5749606406208072, 0.5800365984669558, 0.5553310566382247, 0.5666029116579021, 0.5572084279513663, 0.5701928152387364, 0.5513008188452451, 0.4824424430910648, 0.5341788471521931, 0.5648790704233355, 0.522383670200305, 0.5740468027616005, 0.5479041128901748, 0.5335013835325454, 0.5527506689918985, 0.5580165641087091, 0.542125936140439, 0.48101070903977927, 0.5234835280269731, 0.5480653877788266, 0.5182912498662275, 0.5223353473522595, 0.5485829019139155, 0.6103023329561089, 0.40271635729598093, 0.5420334393988325, 0.5848522708638701, 0.5455319527346216, 0.5266638425163442, 0.5439337685136119, 0.5146255169394188, 0.5093259837007978, 0.5191038411716998, 0.5161754403005105, 0.5153787933545042, 0.44884482506015044, 0.5384680067991876, 0.49215180694262545, 0.49714951993976453, 0.49897874345894033, 0.5182520604300964, 0.495586829198196, 0.5175975233048551, 0.5222589429517953, 0.5207157917870019, 0.5131074147202395, 0.5091797504862662, 0.4807391313617715, 0.5035086427110137, 0.5215235394427867, 0.5011718091754945, 0.4683055273550228, 0.49703004013601965, 0.5072986384210415, 0.5124236329228059, 0.4321366998971699, 0.4870178421934882, 0.4906786006814696, 0.4914824695004038, 0.5145190066723238, 0.47516152360701774, 0.49051944050331314, 0.499651603602882, 0.4599837026211809, 0.48424811530747436, 0.48026523258050813, 0.4731132535372548, 0.46981113327933416, 0.5032733741294888, 0.5317051006858098, 0.47425284821913244, 0.4837320854894604, 0.4716828779479094, 0.5412325348293605, 0.3649407082936043]

x_ar = [i for i in range(len(y_ar))]


plt.plot(x_ar,y_ar,label='Secant method \n gradient descent')
plt.title("Secant Method")
plt.xlabel('No of iterations')
plt.ylabel('J')  
plt.legend()
# plt.savefig('GradDescent_1_copy.png',dpi=500)
plt.show()
# b = nlr_obj.SgradientDescent(x,y,w.copy(),0.001,iters)
# a = nlr_obj.BgradientDescent(x,y,w.copy(),0.001,iters)

# x_ar = [i for i in range(iters)]
# y_ar = a[1]
# y_ar_s = b[1]
# plt.plot(x_ar,y_ar_s)
# plt.plot(x_ar,y_ar)

# plt.show()





# x_arr = np.linspace(0,2.5,100)

# y_arr = a[0][0] + a[0][1]*x_arr + a[0][2]*(x_arr**2)

# plt.plot(x,y,'o')
# plt.plot(x_arr,y_arr)
# plt.show()



# a = nlr_obj.BgradientDescent(x,y,w.copy(),0.001,iters)
# b = nlr_obj.BgradientDescent(x,y,w.copy(),0.0005,iters)
# c = nlr_obj.BgradientDescent(x,y,w.copy(),0.0001,iters)
# d = nlr_obj.BgradientDescent(x,y,w.copy(),0.00005,iters)

# x_ar = [i for i in range(iters)]
# y_ar_a = a[1]
# y_ar_b = b[1]
# y_ar_c = c[1]
# y_ar_d = d[1]
# plt.plot(x_ar,y_ar_a)
# plt.plot(x_ar,y_ar_b)
# plt.plot(x_ar,y_ar_c)
# plt.plot(x_ar,y_ar_d)
# plt.show()
